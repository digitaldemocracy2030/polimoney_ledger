import{a as e}from"./chunk-GUCFFKTL.js";import{a as t}from"./chunk-NJU4TC5B.js";function A({isOpen:L,onClose:v,onSuccess:O}){let[s,o]=t("person"),[h,m]=t(""),[y,g]=t(""),[f,x]=t(""),[c,k]=t(!1),[r,_]=t(!1),[i,C]=t(!1),[n,T]=t("personal_info"),[E,P]=t(""),[p,I]=t(!1),[M,d]=t(null),u=c||r||i,j=async a=>{a.preventDefault(),I(!0),d(null);try{let l=await fetch("/api/contacts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contact_type:s,name:h,address:y||null,occupation:f||null,is_name_private:c,is_address_private:r,is_occupation_private:i,privacy_reason_type:u?n:null,privacy_reason_other:u&&n==="other"?E:null})});if(!l.ok){let w=await l.json();throw new Error(w.error||"\u767B\u9332\u306B\u5931\u6557\u3057\u307E\u3057\u305F")}let b=await l.json();O({id:b.data.id,name:b.data.name,contact_type:b.data.contact_type}),S(),v()}catch(l){d(l instanceof Error?l.message:"\u767B\u9332\u306B\u5931\u6557\u3057\u307E\u3057\u305F")}finally{I(!1)}},S=()=>{o("person"),m(""),g(""),x(""),k(!1),_(!1),C(!1),T("personal_info"),P(""),d(null)},H=()=>{S(),v()};return L?e("div",{class:"modal modal-open",children:[e("div",{class:"modal-box max-w-lg",children:[e("h3",{class:"font-bold text-lg mb-4",children:"\u95A2\u4FC2\u8005\u3092\u8FFD\u52A0"}),e("form",{onSubmit:j,class:"space-y-4",children:[e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:["\u7A2E\u5225 ",e("span",{class:"text-error",children:"*"})]})}),e("div",{class:"flex gap-4",children:[e("label",{class:"label cursor-pointer gap-2",children:[e("input",{type:"radio",name:"contactType",class:"radio radio-primary",checked:s==="person",onChange:()=>o("person")}),e("span",{class:"label-text",children:"\u500B\u4EBA"})]}),e("label",{class:"label cursor-pointer gap-2",children:[e("input",{type:"radio",name:"contactType",class:"radio radio-primary",checked:s==="corporation",onChange:()=>o("corporation")}),e("span",{class:"label-text",children:"\u6CD5\u4EBA"})]})]})]}),e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:[s==="person"?"\u6C0F\u540D":"\u6CD5\u4EBA\u540D"," ",e("span",{class:"text-error",children:"*"})]})}),e("input",{type:"text",class:"input input-bordered",placeholder:s==="person"?"\u4F8B: \u5C71\u7530 \u592A\u90CE":"\u4F8B: \u682A\u5F0F\u4F1A\u793E\u25CB\u25CB",value:h,onChange:a=>m(a.target.value),required:!0})]}),e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:"\u4F4F\u6240"})}),e("input",{type:"text",class:"input input-bordered",placeholder:"\u4F8B: \u6771\u4EAC\u90FD\u5343\u4EE3\u7530\u533A...",value:y,onChange:a=>g(a.target.value)})]}),s==="person"&&e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:"\u8077\u696D"})}),e("input",{type:"text",class:"input input-bordered",placeholder:"\u4F8B: \u4F1A\u793E\u54E1",value:f,onChange:a=>x(a.target.value)})]}),e("div",{class:"divider text-sm",children:"\u30D7\u30E9\u30A4\u30D0\u30B7\u30FC\u8A2D\u5B9A"}),e("div",{class:"space-y-2",children:[e("label",{class:"label cursor-pointer justify-start gap-2",children:[e("input",{type:"checkbox",class:"checkbox checkbox-sm",checked:c,onChange:a=>k(a.target.checked)}),e("span",{class:"label-text",children:"\u6C0F\u540D\u3092\u975E\u516C\u958B\u306B\u3059\u308B"})]}),e("label",{class:"label cursor-pointer justify-start gap-2",children:[e("input",{type:"checkbox",class:"checkbox checkbox-sm",checked:r,onChange:a=>_(a.target.checked)}),e("span",{class:"label-text",children:"\u4F4F\u6240\u3092\u975E\u516C\u958B\u306B\u3059\u308B"})]}),s==="person"&&e("label",{class:"label cursor-pointer justify-start gap-2",children:[e("input",{type:"checkbox",class:"checkbox checkbox-sm",checked:i,onChange:a=>C(a.target.checked)}),e("span",{class:"label-text",children:"\u8077\u696D\u3092\u975E\u516C\u958B\u306B\u3059\u308B"})]})]}),u&&e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:"\u975E\u516C\u958B\u306E\u7406\u7531"})}),e("select",{class:"select select-bordered",value:n,onChange:a=>T(a.target.value),children:[e("option",{value:"personal_info",children:"\u500B\u4EBA\u60C5\u5831\u4FDD\u8B77\u306E\u305F\u3081"}),e("option",{value:"other",children:"\u305D\u306E\u4ED6"})]}),n==="other"&&e("input",{type:"text",class:"input input-bordered mt-2",placeholder:"\u7406\u7531\u3092\u5165\u529B",value:E,onChange:a=>P(a.target.value)})]}),M&&e("div",{class:"alert alert-error",children:e("span",{children:M})}),e("div",{class:"modal-action",children:[e("button",{type:"button",class:"btn btn-ghost",onClick:H,children:"\u30AD\u30E3\u30F3\u30BB\u30EB"}),e("button",{type:"submit",class:`btn btn-primary ${p?"loading":""}`,disabled:p,children:p?"\u767B\u9332\u4E2D...":"\u767B\u9332"})]})]})]}),e("div",{class:"modal-backdrop",onClick:H})]}):null}export{A as a};
