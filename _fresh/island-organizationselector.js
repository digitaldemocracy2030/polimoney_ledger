import{a as e}from"./chunk-GUCFFKTL.js";import{a as o,c as x}from"./chunk-NJU4TC5B.js";import"./chunk-H4FMBZ3H.js";var h={political_party:"\u653F\u515A",support_group:"\u5F8C\u63F4\u4F1A",fund_management:"\u8CC7\u91D1\u7BA1\u7406\u56E3\u4F53",other:"\u305D\u306E\u4ED6\u306E\u653F\u6CBB\u56E3\u4F53"},k={registration_form:"\u653F\u6CBB\u56E3\u4F53\u8A2D\u7ACB\u5C4A\u51FA\u66F8\uFF08\u63A7\u3048\uFF09",name_list:"\u653F\u6CBB\u56E3\u4F53\u540D\u7C3F\u306E\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8",financial_report:"\u653F\u6CBB\u8CC7\u91D1\u53CE\u652F\u5831\u544A\u66F8\u306E\u8868\u7D19"};function T({initialOrganizations:i}){let[a]=o(i),[r,p]=o(""),[c,v]=o(""),[f,u]=o(!1),g=a.filter(s=>{let n=s.name.toLowerCase().includes(r.toLowerCase()),t=!c||s.type===c;return n&&t}).reduce((s,n)=>(s[n.type]||(s[n.type]=[]),s[n.type].push(n),s),{});return e("div",{children:[e("div",{class:"card bg-base-100 shadow-xl mb-6",children:e("div",{class:"card-body",children:e("div",{class:"flex flex-wrap gap-4",children:[e("div",{class:"form-control flex-1 min-w-[200px]",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:"\u{1F50D} \u691C\u7D22"})}),e("input",{type:"text",value:r,onInput:s=>p(s.target.value),placeholder:"\u56E3\u4F53\u540D\u3067\u691C\u7D22...",class:"input input-bordered w-full"})]}),e("div",{class:"form-control w-48",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:"\u7A2E\u5225"})}),e("select",{value:c,onChange:s=>v(s.target.value),class:"select select-bordered w-full",children:[e("option",{value:"",children:"\u3059\u3079\u3066"}),Object.entries(h).map(([s,n])=>e("option",{value:s,children:n},s))]})]})]})})}),e("div",{class:"space-y-6",children:Object.keys(g).length>0?Object.entries(h).map(([s,n])=>{let t=g[s];return!t||t.length===0?null:e("div",{children:[e("h2",{class:"text-xl font-semibold mb-3 flex items-center",children:[e("span",{class:"mr-2",children:"\u{1F3DB}\uFE0F"}),n]}),e("div",{class:"card bg-base-100 shadow-xl",children:e("div",{class:"card-body p-0",children:e("ul",{class:"menu p-0",children:t.map(l=>e("li",{children:e("div",{class:"flex justify-between items-center py-4 px-6 border-b border-base-200 last:border-b-0",children:[e("div",{children:[e("h3",{class:"font-medium",children:l.name}),e("div",{class:"mt-1 flex items-center gap-2",children:[e("span",{class:"badge badge-success badge-sm",children:h[l.type]||l.type}),e("span",{class:"text-xs opacity-70",children:new Date(l.created_at).toLocaleDateString("ja-JP")})]})]}),e("a",{href:`/organizations/${l.id}/ledger`,class:"btn btn-primary btn-sm",children:"\u53F0\u5E33\u3092\u958B\u304F"})]})},l.id))})})})]},s)}):e("div",{class:"card bg-base-100 shadow-xl",children:e("div",{class:"card-body items-center text-center",children:e("p",{class:"text-base-content/70",children:"\u8A72\u5F53\u3059\u308B\u653F\u6CBB\u56E3\u4F53\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093"})})})}),e("div",{role:"alert",class:"alert alert-warning mt-8",children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e("div",{children:[e("h3",{class:"font-bold",children:"\u8A72\u5F53\u3059\u308B\u653F\u6CBB\u56E3\u4F53\u304C\u306A\u3044\u5834\u5408"}),e("p",{class:"text-sm",children:"\u304A\u63A2\u3057\u306E\u653F\u6CBB\u56E3\u4F53\u304C\u898B\u3064\u304B\u3089\u306A\u3044\u5834\u5408\u306F\u3001\u8A3C\u660E\u66F8\u985E\u3092\u6DFB\u4ED8\u3057\u3066\u767B\u9332\u3092\u30EA\u30AF\u30A8\u30B9\u30C8\u3067\u304D\u307E\u3059\u3002"})]}),e("button",{class:"btn btn-sm btn-warning",onClick:()=>u(!0),children:"\u767B\u9332\u3092\u30EA\u30AF\u30A8\u30B9\u30C8"})]}),f&&e(E,{onClose:()=>u(!1)})]})}function E({onClose:i}){let[a,r]=o({name:"",type:"support_group",registration_authority:"",evidence_type:"registration_form",evidence_file_url:"",evidence_file_name:"",notes:"",requested_by_email:""}),[p,c]=o(!1),[v,f]=o(!1),[u,d]=o(null),g=x(null),s=async t=>{let b=t.target.files?.[0];if(b){f(!0),d(null);try{let m=new FormData;m.append("file",b);let y=await fetch("/api/upload",{method:"POST",body:m});if(!y.ok){let _=await y.json();throw new Error(_.error||"\u30D5\u30A1\u30A4\u30EB\u306E\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F")}let w=await y.json();r({...a,evidence_file_url:w.url,evidence_file_name:b.name})}catch(m){d(m instanceof Error?m.message:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u30A8\u30E9\u30FC")}finally{f(!1)}}};return e("dialog",{class:"modal modal-open",children:[e("div",{class:"modal-box max-w-2xl",children:[e("form",{method:"dialog",children:e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",onClick:i,type:"button",children:"\u2715"})}),e("h3",{class:"font-bold text-lg mb-4",children:"\u653F\u6CBB\u56E3\u4F53\u306E\u767B\u9332\u30EA\u30AF\u30A8\u30B9\u30C8"}),u&&e("div",{role:"alert",class:"alert alert-error mb-4",children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e("span",{children:u})]}),e("form",{onSubmit:async t=>{if(t.preventDefault(),!a.evidence_file_url){d("\u8A3C\u660E\u66F8\u985E\u3092\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u3057\u3066\u304F\u3060\u3055\u3044");return}c(!0),d(null);try{let l=await fetch("/api/organization-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!l.ok){let b=await l.json();throw new Error(b.error||"\u30EA\u30AF\u30A8\u30B9\u30C8\u306E\u9001\u4FE1\u306B\u5931\u6557\u3057\u307E\u3057\u305F")}alert("\u767B\u9332\u30EA\u30AF\u30A8\u30B9\u30C8\u3092\u9001\u4FE1\u3057\u307E\u3057\u305F\u3002\u627F\u8A8D\u3055\u308C\u308B\u307E\u3067\u304A\u5F85\u3061\u304F\u3060\u3055\u3044\u3002"),i()}catch(l){d(l instanceof Error?l.message:"\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F")}finally{c(!1)}},class:"space-y-4",children:[e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:["\u56E3\u4F53\u540D ",e("span",{class:"text-error",children:"*"})]})}),e("input",{type:"text",required:!0,value:a.name,onInput:t=>r({...a,name:t.target.value}),placeholder:"\u4F8B: \u5C71\u7530\u592A\u90CE\u5F8C\u63F4\u4F1A",class:"input input-bordered w-full"})]}),e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:["\u56E3\u4F53\u7A2E\u5225 ",e("span",{class:"text-error",children:"*"})]})}),e("select",{required:!0,value:a.type,onChange:t=>r({...a,type:t.target.value}),class:"select select-bordered w-full",children:Object.entries(h).map(([t,l])=>e("option",{value:t,children:l},t))})]}),e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:"\u5C4A\u51FA\u5148"})}),e("input",{type:"text",value:a.registration_authority,onInput:t=>r({...a,registration_authority:t.target.value}),placeholder:"\u4F8B: \u6771\u4EAC\u90FD\u9078\u6319\u7BA1\u7406\u59D4\u54E1\u4F1A",class:"input input-bordered w-full"})]}),e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:["\u8A3C\u660E\u66F8\u985E\u306E\u7A2E\u985E ",e("span",{class:"text-error",children:"*"})]})}),e("select",{required:!0,value:a.evidence_type,onChange:t=>r({...a,evidence_type:t.target.value}),class:"select select-bordered w-full",children:Object.entries(k).map(([t,l])=>e("option",{value:t,children:l},t))})]}),e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:["\u8A3C\u660E\u66F8\u985E\u306E\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9 ",e("span",{class:"text-error",children:"*"})]})}),e("input",{type:"file",ref:g,onChange:s,accept:"image/*,.pdf",class:"file-input file-input-bordered w-full"}),v&&e("span",{class:"mt-2 text-sm",children:[e("span",{class:"loading loading-spinner loading-sm mr-2"}),"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u4E2D..."]}),a.evidence_file_name&&!v&&e("span",{class:"mt-2 text-sm text-success",children:["\u2705 ",a.evidence_file_name]}),e("label",{class:"label",children:e("span",{class:"label-text-alt",children:"\u653F\u6CBB\u56E3\u4F53\u8A2D\u7ACB\u5C4A\u51FA\u66F8\u306E\u63A7\u3048\u3001\u540D\u7C3F\u306E\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8\u7B49\u3092\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u3057\u3066\u304F\u3060\u3055\u3044"})})]}),e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:"\u9023\u7D61\u5148\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9"})}),e("input",{type:"email",value:a.requested_by_email,onInput:t=>r({...a,requested_by_email:t.target.value}),placeholder:"example@email.com",class:"input input-bordered w-full"})]}),e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:"\u5099\u8003"})}),e("textarea",{value:a.notes,onInput:t=>r({...a,notes:t.target.value}),rows:3,class:"textarea textarea-bordered w-full"})]}),e("div",{class:"modal-action",children:[e("button",{type:"button",class:"btn btn-ghost",onClick:i,children:"\u30AD\u30E3\u30F3\u30BB\u30EB"}),e("button",{type:"submit",class:`btn btn-primary ${p?"loading":""}`,disabled:p||!a.evidence_file_url,children:p?"\u9001\u4FE1\u4E2D...":"\u30EA\u30AF\u30A8\u30B9\u30C8\u3092\u9001\u4FE1"})]})]})]}),e("form",{method:"dialog",class:"modal-backdrop",children:e("button",{onClick:i,children:"close"})})]})}export{T as default};
