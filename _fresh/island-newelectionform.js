import{a as e}from"./chunk-GUCFFKTL.js";import{a as n}from"./chunk-NJU4TC5B.js";import"./chunk-H4FMBZ3H.js";var y={HR:"\u8846\u8B70\u9662\u8B70\u54E1\u9078\u6319",HC:"\u53C2\u8B70\u9662\u8B70\u54E1\u9078\u6319",PG:"\u90FD\u9053\u5E9C\u770C\u77E5\u4E8B\u9078\u6319",PA:"\u90FD\u9053\u5E9C\u770C\u8B70\u4F1A\u9078\u6319",GM:"\u5E02\u533A\u753A\u6751\u9577\u9078\u6319",CM:"\u5E02\u533A\u753A\u6751\u8B70\u4F1A\u9078\u6319"};function h(r){return r.reduce((a,o)=>{let l=new Date(o.election_date).getFullYear().toString();return a[l]||(a[l]=[]),a[l].push(o),a},{})}function _({hubElections:r}){let[a,o]=n(null),[l,x]=n(""),[d,m]=n(!1),[f,c]=n(null),[p,E]=n(""),[b,w]=n("all"),S=h(r),k=Object.keys(S).sort((s,t)=>Number(t)-Number(s)),v=r.filter(s=>{let t=p===""||s.name.toLowerCase().includes(p.toLowerCase()),i=b==="all"||s.type===b;return t&&i}),g=h(v);return e("form",{onSubmit:async s=>{if(s.preventDefault(),!a){c("\u9078\u6319\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044");return}if(!l.trim()){c("\u653F\u6CBB\u5BB6\u540D\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044");return}m(!0),c(null);try{let t=r.find(u=>u.id===a),i=await fetch("/api/elections",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hub_election_id:a,election_name:t?.name,election_date:t?.election_date,politician_name:l})});if(!i.ok){let u=await i.json();throw new Error(u.error||"\u9078\u6319\u53F0\u5E33\u306E\u4F5C\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F")}let N=await i.json();window.location.href=`/elections/${N.election_id}/ledger`}catch(t){c(t instanceof Error?t.message:"\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F")}finally{m(!1)}},children:[f&&e("div",{class:"alert alert-error mb-4",children:e("span",{children:f})}),e("div",{class:"mb-6",children:[e("h3",{class:"font-bold text-lg mb-4",children:"1. \u9078\u6319\u3092\u9078\u629E"}),e("div",{class:"flex flex-col md:flex-row gap-4 mb-4",children:[e("div",{class:"form-control flex-1",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:"\u{1F50D} \u691C\u7D22"})}),e("input",{type:"text",placeholder:"\u9078\u6319\u540D\u3067\u691C\u7D22...",class:"input input-bordered",value:p,onInput:s=>E(s.target.value)})]}),e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:"\u7A2E\u5225"})}),e("select",{class:"select select-bordered",value:b,onChange:s=>w(s.target.value),children:[e("option",{value:"all",children:"\u3059\u3079\u3066"}),Object.entries(y).map(([s,t])=>e("option",{value:s,children:t},s))]})]})]}),e("div",{class:"max-h-96 overflow-y-auto border rounded-lg",children:v.length===0?e("div",{class:"p-8 text-center text-base-content/70",children:"\u8A72\u5F53\u3059\u308B\u9078\u6319\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093"}):Object.keys(g).sort((s,t)=>Number(t)-Number(s)).map(s=>e("div",{children:[e("div",{class:"sticky top-0 bg-base-200 px-4 py-2 font-bold border-b",children:["\u{1F4C5} ",s,"\u5E74"]}),g[s].map(t=>e("label",{class:`flex items-center gap-4 p-4 cursor-pointer hover:bg-base-200 border-b ${a===t.id?"bg-primary/10":""}`,children:[e("input",{type:"radio",name:"election",class:"radio radio-primary",checked:a===t.id,onChange:()=>o(t.id)}),e("div",{class:"flex-1",children:[e("div",{class:"font-medium",children:t.name}),e("div",{class:"flex gap-2 mt-1",children:[e("span",{class:"badge badge-sm badge-info",children:y[t.type]||t.type}),e("span",{class:"text-xs text-base-content/70",children:new Date(t.election_date).toLocaleDateString("ja-JP")})]})]})]},t.id))]},s))}),e("div",{class:"alert alert-warning mt-4",children:e("span",{children:["\u8A72\u5F53\u3059\u308B\u9078\u6319\u304C\u306A\u3044\u5834\u5408\u306F\u3001",e("a",{href:"/elections/request",class:"link link-primary",children:"\u767B\u9332\u3092\u30EA\u30AF\u30A8\u30B9\u30C8"}),"\u3057\u3066\u304F\u3060\u3055\u3044\u3002"]})})]}),e("div",{class:"mb-6",children:[e("h3",{class:"font-bold text-lg mb-4",children:"2. \u653F\u6CBB\u5BB6\u540D\u3092\u5165\u529B"}),e("div",{class:"form-control",children:[e("label",{class:"label",children:e("span",{class:"label-text",children:["\u5019\u88DC\u8005\u30FB\u5F53\u9078\u8005\u306E\u6C0F\u540D ",e("span",{class:"text-error",children:"*"})]})}),e("input",{type:"text",placeholder:"\u4F8B: \u5C71\u7530 \u592A\u90CE",class:"input input-bordered",value:l,onInput:s=>x(s.target.value),required:!0}),e("label",{class:"label",children:e("span",{class:"label-text-alt text-base-content/70",children:"\u3053\u306E\u9078\u6319\u306B\u51FA\u99AC\u3057\u305F/\u3059\u308B\u653F\u6CBB\u5BB6\u306E\u540D\u524D\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044"})})]})]}),e("div",{class:"flex gap-4",children:[e("a",{href:"/elections",class:"btn btn-outline",children:"\u30AD\u30E3\u30F3\u30BB\u30EB"}),e("button",{type:"submit",class:`btn btn-primary flex-1 ${d?"loading":""}`,disabled:d||!a||!l.trim(),children:d?"\u4F5C\u6210\u4E2D...":"\u9078\u6319\u53F0\u5E33\u3092\u4F5C\u6210"})]})]})}export{_ as default};
